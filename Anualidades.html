<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="Author" content="Chaira Zapa">
    <link rel="icon" href="images/iconfin.png" type="image/gif" />
    <link rel="stylesheet" href="css/estildos.css">
    <title>FinancePro</title>
</head>
<body>
     
  <header class="header">
    <div class="menu-container">
      <ul class="menu">
        <li><a href="index.html">Home</a></li>
        <li><a href="Anualidades.html">Annuities</a></li>
        <li><a href="Gradiente.html">Gradients</a></li>
        <li><a href="AlternativasInversion.html">Investment</a></li>
      </ul>
    </div>
  </header>

  <div class="formulario">
    <h1>AQUÍ PUEDES CALCULAR:</h1>
    <form id="calcForm">
        <select id="Tema" name="calculo" required>
            <option value=""></option>
            <option value="vencida">ANUALIDAD VENCIDA</option>
            <option value="anticipada">ANUALIDAD ANTICIPADA</option>
        </select>
        <br>
        <select id="variable" onchange="showContent(this.value)" required>
          <option value=""></option>
          <option value="VP">Valor Presente</option>
          <option value="VF">Valor final</option>
          <option value="nVP">Número periodos usando valor presente</option>
          <option value="nVF">Número periodos usando valor final</option>
          <option value="AVP">Anualidad usando valor presente</option>
          <option value="AVF">Anualidad usando valor final</option>
        </select> 

        <div id="contenido"></div>
        <br>
        <select id="tabla">
          <option value=""></option>
          <option value="Amortizar">Amortizar</option>
          <option value="Capitalizar">Capitalizar</option>
        </select>
        <br>
        <button type="button" onclick="calcular()">CALCULAR</button>

        <label for="resultado">RESULTADO:</label>
        <input type="number" id="resultado" name="resultado" readonly>
        <br>
        <div id="result" class="tabla"></div>
    </form>
  </div>

<script>
    function limpiarCampos() {
        document.getElementById('Tema').value = "";
        document.getElementById('variable').value = "";
        document.getElementById('tabla').value = "";
        document.getElementById('dato1').value = "";
        document.getElementById('dato2').value = "";
        document.getElementById('dato3').value = "";
    }

    function realizarTabla(selectTabla, VP, A, n, i) {
        if (selectTabla == "Capitalizar") {
            capitalizarAmortizarAnualidades(VP, A, n, i, 1);
        } else if (selectTabla == "Amortizar") {
            capitalizarAmortizarAnualidades(VP, A, n, i, 2);
        }
    }

    function realizarTablaAnticipadas(selectTabla, VP, A, n, i) {
        if (selectTabla == "Capitalizar") {
            capitalizarAmortizarAnualidadesAnticipadas(VP, A, n, i, 1);
        } else if (selectTabla == "Amortizar") {
            capitalizarAmortizarAnualidadesAnticipadas(VP, A, n, i, 2);
        }
    }

    function showContent(variable) {
        const contenido = document.getElementById("contenido");
        contenido.innerHTML = '';

        switch (variable) {
            case 'VP':
            case 'VF':
                contenido.innerHTML = `
                    <br><label>Anualidad</label><br>
                    <input type="number" id="dato1" placeholder="Ingrese (A)" required><br>
                    <label>Tasa de interes</label><br>
                    <input type="number" id="dato2" placeholder="Ingrese (i)" required><br>
                    <label>Número de periodos</label><br>
                    <input type="number" id="dato3" placeholder="Ingrese (n)" required>
                `;
                break;
            case 'nVP':
                contenido.innerHTML = `
                    <br><label>Anualidad</label><br>
                    <input type="number" id="dato1" placeholder="Ingrese (A)" required><br>
                    <label>Valor Presente</label><br>
                    <input type="number" id="dato2" placeholder="Ingrese (VP)" required><br>
                    <label>Tasa de interés</label><br>
                    <input type="number" id="dato3" placeholder="Ingrese (i)" required>
                `;
                break;
            case 'nVF':
                contenido.innerHTML = `
                    <br><label>Anualidad</label><br>
                    <input type="number" id="dato1" placeholder="Ingrese (A)" required><br>
                    <label>Valor Futuro</label><br>
                    <input type="number" id="dato2" placeholder="Ingrese (VP)" required><br>
                    <label>Tasa de interés</label><br>
                    <input type="number" id="dato3" placeholder="Ingrese (i)" required>
                `;
                break;
            case 'AVP':
                contenido.innerHTML = `
                    <br><label>Valor Presente</label><br>
                    <input type="number" id="dato1" placeholder="Ingrese (VP)" required><br>
                    <label>Tasa de interés</label><br>
                    <input type="number" id="dato2" placeholder="Ingrese (i)" required><br>
                    <label>Número periodos</label><br>
                    <input type="number" id="dato3" placeholder="Ingrese (n)" required>
                `;
                break;
            case 'AVF':
                contenido.innerHTML = `
                    <br><label>Valor Final</label><br>
                    <input type="number" id="dato1" placeholder="Ingrese (VP)" required><br>
                    <label>Tasa de interés</label><br>
                    <input type="number" id="dato2" placeholder="Ingrese (i)" required><br>
                    <label>Número periodos</label><br>
                    <input type="number" id="dato3" placeholder="Ingrese (n)" required>
                `;
                break;
            default:
                break;
        }
    }

    function calcular() {
        const selectTema = document.getElementById('Tema').value;
        const selectVariable = document.getElementById('variable').value;
        const selectTabla = document.getElementById('tabla').value;
    
        if (selectTema == "" && selectVariable == "" && selectTabla == "") {
            alert('No ha seleccionado ninguna opción, seleccione una');
            return;
        }
        if (selectTema == "") {
            alert('Por favor seleccione al menos un tema');
            return;
        }
        if (selectVariable == "") {
            alert('Por favor seleccione al menos una variable');
            return;
        }
        if (selectTabla == "") {
            alert('Por favor seleccione al menos un caso para la tabla');
            return;
        }
     
        if (selectTema == "vencida") {
            switch (selectVariable) {
                case 'VP':
                    var A = parseFloat(document.getElementById('dato1').value);
                    var i = parseFloat(document.getElementById('dato2').value) / 100;
                    var n = parseFloat(document.getElementById('dato3').value);

                    var VP = A * ((1 + i) ** (n) - 1) / (i * (1 + i) ** n);
                    document.getElementById('resultado').value = VP;
                    realizarTabla(selectTabla, VP, A, n, i);
                    limpiarCampos();
                    break;
                case 'VF':
                    var A = parseFloat(document.getElementById('dato1').value);
                    var i = parseFloat(document.getElementById('dato2').value) / 100;
                    var n = parseFloat(document.getElementById('dato3').value);

                    var VF = A * (((1 + i) ** (n) - 1) / i);
                    document.getElementById('resultado').value = VF;
                    realizarTabla(selectTabla, 0, A, n, i);
                    limpiarCampos();
                    break; 
                case 'nVP':
                    var A = parseFloat(document.getElementById('dato1').value);
                    var VP = parseFloat(document.getElementById('dato2').value);
                    var i = parseFloat(document.getElementById('dato3').value) / 100;

                    var n = (Math.log((VP * i / A) + 1)) / (Math.log(1 + i));
                    document.getElementById('resultado').value = n;
                    realizarTabla(selectTabla, VP, A, n, i);
                    limpiarCampos();
                    break;
                case 'nVF':
                    var A = parseFloat(document.getElementById('dato1').value);
                    var VF = parseFloat(document.getElementById('dato2').value);
                    var i = parseFloat(document.getElementById('dato3').value) / 100;

                    var n = (Math.log((i / A) + 1)) / (Math.log(1 + i));
                    document.getElementById('resultado').value = n;
                    realizarTabla(selectTabla, 0, A, n, i);
                    limpiarCampos();
                    break;
                case 'AVP':
                    var VP = parseFloat(document.getElementById('dato1').value);
                    var i = parseFloat(document.getElementById('dato2').value) / 100;
                    var n = parseFloat(document.getElementById('dato3').value);

                    var A = VP * (i * (1 + i) ** (n)) / ((1 + i) ** (n) - 1);
                    document.getElementById('resultado').value = A;
                    realizarTabla(selectTabla, VP, A, n, i);
                    limpiarCampos();
                    break;
                case 'AVF':
                    var VF = parseFloat(document.getElementById('dato1').value);
                    var i = parseFloat(document.getElementById('dato2').value) / 100;
                    var n = parseFloat(document.getElementById('dato3').value);

                    var A = VF * i / (((1 + i) ** (n)) - 1);
                    document.getElementById('resultado').value = A;
                    realizarTabla(selectTabla, 0, A, n, i);
                    limpiarCampos();
                    break;
                default:
                    break;
            }
        }

        if (selectTema == "anticipada") {
            switch (selectVariable) {
                case 'VP':
                    var A = parseFloat(document.getElementById('dato1').value);
                    var i = parseFloat(document.getElementById('dato2').value) / 100;
                    var n = parseFloat(document.getElementById('dato3').value);

                    var VP = A * ((1 + i) ** (n) - 1) / (i * (1 + i) ** (n-1));
                    document.getElementById('resultado').value = VP;
                    realizarTablaAnticipadas(selectTabla, VP, A, n, i);
                    limpiarCampos();
                    break;
                case 'VF':
                    var A = parseFloat(document.getElementById('dato1').value);
                    var i = parseFloat(document.getElementById('dato2').value) / 100;
                    var n = parseFloat(document.getElementById('dato3').value);

                    var VF = A * (((1 + i) ** (n) - 1) / i) * (1 + i);
                    document.getElementById('resultado').value = VF;
                    realizarTablaAnticipadas(selectTabla, 0, A, n, i);
                    limpiarCampos();
                    break; 
                case 'nVP':
                    var A = parseFloat(document.getElementById('dato1').value);
                    var VP = parseFloat(document.getElementById('dato2').value);
                    var i = parseFloat(document.getElementById('dato3').value) / 100;

                    var n = (Math.log((VP * i / A) + 1)) / (Math.log(1 + i));
                    document.getElementById('resultado').value = n;
                    realizarTablaAnticipadas(selectTabla, VP, A, n, i);
                    limpiarCampos();
                    break;
                case 'nVF':
                    var A = parseFloat(document.getElementById('dato1').value);
                    var VF = parseFloat(document.getElementById('dato2').value);
                    var i = parseFloat(document.getElementById('dato3').value) / 100;

                    var n = (Math.log((i / A) + 1)) / (Math.log(1 + i));
                    document.getElementById('resultado').value = n;
                    realizarTablaAnticipadas(selectTabla, 0, A, n, i);
                    limpiarCampos();
                    break;
                case 'AVP':
                    var VP = parseFloat(document.getElementById('dato1').value);
                    var i = parseFloat(document.getElementById('dato2').value) / 100;
                    var n = parseFloat(document.getElementById('dato3').value);

                    var A = VP * (i * (1 + i) ** (n-1)) / ((1 + i) ** (n) - 1);
                    document.getElementById('resultado').value = A;
                    realizarTablaAnticipadas(selectTabla, VP, A, n, i);
                    limpiarCampos();
                    break;
                case 'AVF':
                    var VF = parseFloat(document.getElementById('dato1').value);
                    var i = parseFloat(document.getElementById('dato2').value) / 100;
                    var n = parseFloat(document.getElementById('dato3').value);

                    var A = VF * i / (((1 + i) ** (n)) - 1);
                    document.getElementById('resultado').value = A;
                    realizarTablaAnticipadas(selectTabla, 0, A, n, i);
                    limpiarCampos();
                    break;
                default:
                    break;
            }
        }
    }
</script>

</body>
</html>

